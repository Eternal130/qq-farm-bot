import{d as N,b as $}from"./index-Be1OEmQm.js";import{d as U,Q as G,R as b,c as _,b as n,w as o,e as l,S as B,E as c,r as C,o as i,T as m,a as t,A as p,l as F,U as k,V as S,W as R,v as u,X as q,Y as z,Z as L,D as P,q as v,t as r,_ as w,$ as M,p as Q,a0 as W,s as h}from"./index-DZf8Hpes.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"dashboard"},Z={class:"stat-content"},j={class:"stat-content"},H={class:"stat-content"},J={class:"card-header"},K={class:"bot-header"},O={class:"bot-name"},ss={class:"platform-tag"},ts={class:"bot-stats"},es={class:"stat-item"},as={class:"value"},ls={class:"stat-item"},ns={class:"value gold"},os={class:"stat-item"},ds={class:"value"},rs={class:"bot-stats bot-stats-extra"},is={class:"stat-item"},_s={class:"value steal"},us={class:"stat-item"},cs={class:"value help"},ps={class:"stat-item"},vs={class:"value"},fs={key:0,class:"level-up-info"},ms={key:0,class:"level-up-value"},hs={key:1,class:"level-up-value"},gs={class:"land-overview"},ys={class:"land-value"},xs={key:1,class:"land-grid"},ks={class:"land-cell-header"},ws={class:"land-id"},Es={class:"land-level"},$s={class:"land-crop"},Bs=U({__name:"DashboardView",setup(Cs){const f=C({totalAccounts:0,runningBots:0,totalGold:0}),g=C([]);let y=null;const x=async()=>{try{const a=(await N.getStats()).data;f.value={totalAccounts:a.total_accounts,runningBots:a.running_bots,totalGold:a.total_gold},g.value=a.accounts.map(s=>({id:s.id,name:s.name,level:s.level,gold:s.gold,exp:s.exp,status:s.status,platform:s.platform,total_steal:s.total_steal,total_help:s.total_help,friends_count:s.friends_count,total_lands:s.total_lands,unlocked_lands:s.unlocked_lands,lands:s.lands||[],exp_rate_per_hour:s.exp_rate_per_hour||0,next_level_exp:s.next_level_exp||0,exp_to_next_level:s.exp_to_next_level||0,hours_to_next_level:s.hours_to_next_level||0}))}catch(e){console.error("Failed to fetch dashboard:",e)}},T=async e=>{try{e.status==="running"?(await $.stop(e.id),h.success(`已停止 ${e.name}`)):(await $.start(e.id),h.success(`已启动 ${e.name}`)),await x()}catch(a){const s=a.response?.data?.error||"操作失败";s.includes("no login code")?h.warning("该账号尚未登录，请前往账号管理页面扫码登录"):h.error(s)}},V=e=>e==="running"?"success":e==="error"?"danger":"info",A=e=>e==="running"?"运行中":e==="error"?"错误":"已停止",D=e=>e?e==="成熟"?"success":e==="枯萎"?"danger":e==="开花"?"warning":["发芽","小叶","大叶"].includes(e)?"primary":"info":"info",I=e=>{if(e<=0)return"-";if(e<1)return`${Math.round(e*60)}分钟`;if(e<24){const d=Math.floor(e),E=Math.round((e-d)*60);return E>0?`${d}小时${E}分`:`${d}小时`}const a=Math.floor(e/24),s=Math.round(e%24);return s>0?`${a}天${s}小时`:`${a}天`};return G(()=>{x(),y=window.setInterval(x,5e3)}),b(()=>{y&&clearInterval(y)}),(e,a)=>(i(),_("div",Y,[n(l(B),{gutter:20,class:"stats-row"},{default:o(()=>[n(l(m),{xs:24,sm:8,md:8},{default:o(()=>[n(l(c),{class:"stat-card",shadow:"hover"},{default:o(()=>[t("div",Z,[n(l(p),{class:"stat-icon",size:32,color:"#409eff"},{default:o(()=>[n(l(F))]),_:1}),n(l(k),{title:"账号总数",value:f.value.totalAccounts},null,8,["value"])])]),_:1})]),_:1}),n(l(m),{xs:24,sm:8,md:8},{default:o(()=>[n(l(c),{class:"stat-card",shadow:"hover"},{default:o(()=>[t("div",j,[n(l(p),{class:"stat-icon",size:32,color:"#67c23a"},{default:o(()=>[n(l(S))]),_:1}),n(l(k),{title:"运行中",value:f.value.runningBots},null,8,["value"])])]),_:1})]),_:1}),n(l(m),{xs:24,sm:8,md:8},{default:o(()=>[n(l(c),{class:"stat-card",shadow:"hover"},{default:o(()=>[t("div",H,[n(l(p),{class:"stat-icon",size:32,color:"#e6a23c"},{default:o(()=>[n(l(R))]),_:1}),n(l(k),{title:"金币总额",value:f.value.totalGold,formatter:s=>s.toLocaleString()},null,8,["value","formatter"])])]),_:1})]),_:1})]),_:1}),n(l(c),{class:"bots-card",shadow:"never"},{header:o(()=>[t("div",J,[t("span",null,[n(l(p),null,{default:o(()=>[n(l(P))]),_:1}),a[0]||(a[0]=v(" 账号状态",-1))])])]),default:o(()=>[g.value.length===0?(i(),u(l(q),{key:0,description:"暂无账号，请先添加账号"})):(i(),u(l(B),{key:1,gutter:16},{default:o(()=>[(i(!0),_(z,null,L(g.value,s=>(i(),u(l(m),{key:s.id,xs:24,sm:12,md:8,lg:6,class:"bot-col"},{default:o(()=>[n(l(c),{class:"bot-card","body-style":{padding:"16px"},shadow:"hover"},{default:o(()=>[t("div",K,[t("div",O,[t("span",ss,r(s.platform.toUpperCase()),1),v(" "+r(s.name),1)]),n(l(w),{type:V(s.status),size:"small"},{default:o(()=>[v(r(A(s.status)),1)]),_:2},1032,["type"])]),t("div",ts,[t("div",es,[a[1]||(a[1]=t("span",{class:"label"},"等级",-1)),t("span",as,"Lv."+r(s.level),1)]),t("div",ls,[a[2]||(a[2]=t("span",{class:"label"},"金币",-1)),t("span",ns,r(s.gold.toLocaleString()),1)]),t("div",os,[a[3]||(a[3]=t("span",{class:"label"},"经验",-1)),t("span",ds,r(s.exp.toLocaleString()),1)])]),t("div",rs,[t("div",is,[a[4]||(a[4]=t("span",{class:"label"},"偷菜",-1)),t("span",_s,r(s.total_steal),1)]),t("div",us,[a[5]||(a[5]=t("span",{class:"label"},"帮助",-1)),t("span",cs,r(s.total_help),1)]),t("div",ps,[a[6]||(a[6]=t("span",{class:"label"},"好友",-1)),t("span",vs,r(s.friends_count),1)])]),s.status==="running"&&s.exp_to_next_level>0?(i(),_("div",fs,[a[7]||(a[7]=t("span",{class:"level-up-label"},"升级",-1)),s.hours_to_next_level>0?(i(),_("span",ms," 预计 "+r(I(s.hours_to_next_level)),1)):(i(),_("span",hs," 计算中... "))])):M("",!0),t("div",gs,[a[8]||(a[8]=t("span",{class:"land-label"},"土地",-1)),t("span",ys,r(s.unlocked_lands)+"/"+r(s.total_lands)+" 已解锁",1)]),s.lands&&s.lands.filter(d=>d.unlocked).length>0?(i(),_("div",xs,[(i(!0),_(z,null,L(s.lands.filter(d=>d.unlocked),d=>(i(),_("div",{class:"land-cell",key:d.id},[t("div",ks,[t("span",ws,"#"+r(d.id),1),t("span",Es,"Lv."+r(d.level),1)]),t("div",$s,r(d.crop_name||"空地"),1),d.phase?(i(),u(l(w),{key:0,type:D(d.phase),size:"small",class:"phase-tag"},{default:o(()=>[v(r(d.phase),1)]),_:2},1032,["type"])):(i(),u(l(w),{key:1,type:"info",size:"small",class:"phase-tag"},{default:o(()=>[...a[9]||(a[9]=[v("空地",-1)])]),_:1}))]))),128))])):M("",!0),n(l(Q),{type:s.status==="running"?"danger":"success",size:"small",class:"control-btn",onClick:d=>T(s)},{default:o(()=>[n(l(p),null,{default:o(()=>[s.status==="running"?(i(),u(l(W),{key:0})):(i(),u(l(S),{key:1}))]),_:2},1024)]),_:2},1032,["type","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]))}}),Ms=X(Bs,[["__scopeId","data-v-602d0e00"]]);export{Ms as default};
