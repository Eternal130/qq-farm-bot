import{d as z,b as w}from"./index-Be1OEmQm.js";import{d as A,R as I,S as D,c as _,e as d,w as i,f as l,T as $,E as T,s as B,o as r,U as v,b as s,B as c,m as U,t as n,V as C,W as F,x as u,X as G,Y as E,Z as L,F as N,_ as f,$ as M,q as R,a0 as b,v as m}from"./index-D5Rhts30.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"dashboard"},X={class:"stat-card stat-card--accounts"},Y={class:"stat-icon-wrapper stat-icon--green"},Z={class:"stat-info"},j={class:"stat-value"},H={class:"stat-card stat-card--running"},J={class:"stat-icon-wrapper stat-icon--emerald"},K={class:"stat-info"},O={class:"stat-value"},Q={class:"stat-card stat-card--gold"},ss={class:"stat-icon-wrapper stat-icon--gold"},ts={class:"stat-info"},as={class:"stat-value"},es={class:"card-header"},ls={class:"header-title"},ns={class:"bot-card"},os={class:"bot-header"},ds={class:"bot-name"},is={class:"bot-name-text"},rs={class:"status-text"},_s={class:"bot-stats"},cs={class:"stat-item"},us={class:"stat-value"},ps={class:"stat-item"},vs={class:"stat-value stat-value--gold"},fs={class:"stat-item"},ms={class:"stat-value"},hs={class:"bot-stats bot-stats--secondary"},gs={class:"stat-item"},xs={class:"stat-value"},ys={class:"stat-item"},ks={class:"stat-value stat-value--help"},ws={class:"stat-item"},$s={class:"stat-value"},Bs={key:0,class:"level-up-info"},Cs={key:0,class:"level-up-value"},Es={key:1,class:"level-up-value"},Ls={class:"land-overview"},Ms={class:"land-value"},Ss={key:1,class:"land-grid"},Vs={class:"land-cell-header"},qs={class:"land-id"},zs={class:"land-level"},As={class:"land-crop"},Is=A({__name:"DashboardView",setup(Ds){const p=B({totalAccounts:0,runningBots:0,totalGold:0}),h=B([]);let g=null;const x=async()=>{try{const a=(await z.getStats()).data;p.value={totalAccounts:a.total_accounts,runningBots:a.running_bots,totalGold:a.total_gold},h.value=a.accounts.map(t=>({id:t.id,name:t.name,level:t.level,gold:t.gold,exp:t.exp,status:t.status,platform:t.platform,total_steal:t.total_steal,total_help:t.total_help,friends_count:t.friends_count,total_lands:t.total_lands,unlocked_lands:t.unlocked_lands,lands:t.lands||[],exp_rate_per_hour:t.exp_rate_per_hour||0,next_level_exp:t.next_level_exp||0,exp_to_next_level:t.exp_to_next_level||0,hours_to_next_level:t.hours_to_next_level||0}))}catch(e){console.error("Failed to fetch dashboard:",e)}},S=async e=>{try{e.status==="running"?(await w.stop(e.id),m.success(`已停止 ${e.name}`)):(await w.start(e.id),m.success(`已启动 ${e.name}`)),await x()}catch(a){const t=a.response?.data?.error||"操作失败";t.includes("no login code")?m.warning("该账号尚未登录，请前往账号管理页面扫码登录"):m.error(t)}},V=e=>e==="running"?"运行中":e==="error"?"错误":"已停止",y=e=>e?e==="成熟"?"success":e==="枯萎"?"danger":e==="开花"?"warning":["发芽","小叶","大叶"].includes(e)?"primary":"info":"info",q=e=>{if(e<=0)return"-";if(e<1)return`${Math.round(e*60)}分钟`;if(e<24){const o=Math.floor(e),k=Math.round((e-o)*60);return k>0?`${o}小时${k}分`:`${o}小时`}const a=Math.floor(e/24),t=Math.round(e%24);return t>0?`${a}天${t}小时`:`${a}天`};return I(()=>{x(),g=window.setInterval(x,5e3)}),D(()=>{g&&clearInterval(g)}),(e,a)=>(r(),_("div",W,[d(l($),{gutter:20,class:"stats-row"},{default:i(()=>[d(l(v),{xs:24,sm:8,md:8},{default:i(()=>[s("div",X,[s("div",Y,[d(l(c),{size:24},{default:i(()=>[d(l(U))]),_:1})]),s("div",Z,[a[0]||(a[0]=s("span",{class:"stat-title"},"账号总数",-1)),s("span",j,n(p.value.totalAccounts),1)])])]),_:1}),d(l(v),{xs:24,sm:8,md:8},{default:i(()=>[s("div",H,[s("div",J,[d(l(c),{size:24},{default:i(()=>[d(l(C))]),_:1})]),s("div",K,[a[1]||(a[1]=s("span",{class:"stat-title"},"运行中",-1)),s("span",O,n(p.value.runningBots),1)])])]),_:1}),d(l(v),{xs:24,sm:8,md:8},{default:i(()=>[s("div",Q,[s("div",ss,[d(l(c),{size:24},{default:i(()=>[d(l(F))]),_:1})]),s("div",ts,[a[2]||(a[2]=s("span",{class:"stat-title"},"金币总额",-1)),s("span",as,n(p.value.totalGold.toLocaleString()),1)])])]),_:1})]),_:1}),d(l(T),{class:"bots-card",shadow:"never"},{header:i(()=>[s("div",es,[s("div",ls,[d(l(c),{class:"header-icon"},{default:i(()=>[d(l(N))]),_:1}),a[3]||(a[3]=s("span",null,"账号状态",-1))])])]),default:i(()=>[h.value.length===0?(r(),u(l(G),{key:0,description:"暂无账号，请先添加账号"})):(r(),u(l($),{key:1,gutter:16},{default:i(()=>[(r(!0),_(E,null,L(h.value,t=>(r(),u(l(v),{key:t.id,xs:24,sm:12,md:8,lg:6,class:"bot-col"},{default:i(()=>[s("div",ns,[s("div",os,[s("div",ds,[s("span",{class:f(["platform-tag",t.platform==="qq"?"platform-qq":"platform-wx"])},n(t.platform.toUpperCase()),3),s("span",is,n(t.name),1)]),s("div",{class:f(["bot-status",t.status==="running"?"status-running":"status-stopped"])},[a[4]||(a[4]=s("span",{class:"status-dot"},null,-1)),s("span",rs,n(V(t.status)),1)],2)]),s("div",_s,[s("div",cs,[a[5]||(a[5]=s("span",{class:"stat-label"},"等级",-1)),s("span",us,"Lv."+n(t.level),1)]),s("div",ps,[a[6]||(a[6]=s("span",{class:"stat-label"},"金币",-1)),s("span",vs,n(t.gold.toLocaleString()),1)]),s("div",fs,[a[7]||(a[7]=s("span",{class:"stat-label"},"经验",-1)),s("span",ms,n(t.exp.toLocaleString()),1)])]),s("div",hs,[s("div",gs,[a[8]||(a[8]=s("span",{class:"stat-label"},"偷菜",-1)),s("span",xs,n(t.total_steal),1)]),s("div",ys,[a[9]||(a[9]=s("span",{class:"stat-label"},"帮助",-1)),s("span",ks,n(t.total_help),1)]),s("div",ws,[a[10]||(a[10]=s("span",{class:"stat-label"},"好友",-1)),s("span",$s,n(t.friends_count),1)])]),t.status==="running"&&t.exp_to_next_level>0?(r(),_("div",Bs,[a[11]||(a[11]=s("span",{class:"level-up-label"},"升级",-1)),t.hours_to_next_level>0?(r(),_("span",Cs," 预计 "+n(q(t.hours_to_next_level)),1)):(r(),_("span",Es," 计算中... "))])):M("",!0),s("div",Ls,[a[12]||(a[12]=s("span",{class:"land-label"},"土地",-1)),s("span",Ms,n(t.unlocked_lands)+"/"+n(t.total_lands)+" 已解锁",1)]),t.lands&&t.lands.filter(o=>o.unlocked).length>0?(r(),_("div",Ss,[(r(!0),_(E,null,L(t.lands.filter(o=>o.unlocked),o=>(r(),_("div",{class:f(["land-cell","phase-cell-"+y(o.phase)]),key:o.id},[s("div",Vs,[s("span",qs,"#"+n(o.id),1),s("span",zs,"Lv."+n(o.level),1)]),s("div",As,n(o.crop_name||"空地"),1),s("div",{class:f(["land-phase","phase-"+y(o.phase)])},n(o.phase||"空地"),3)],2))),128))])):M("",!0),d(l(R),{type:t.status==="running"?"danger":"success",size:"default",class:"control-btn",onClick:o=>S(t)},{default:i(()=>[d(l(c),{class:"control-icon"},{default:i(()=>[t.status==="running"?(r(),u(l(b),{key:0})):(r(),u(l(C),{key:1}))]),_:2},1024),s("span",null,n(t.status==="running"?"停止运行":"启动运行"),1)]),_:2},1032,["type","onClick"])])]),_:2},1024))),128))]),_:1}))]),_:1})]))}}),Gs=P(Is,[["__scopeId","data-v-f16ae4f8"]]);export{Gs as default};
